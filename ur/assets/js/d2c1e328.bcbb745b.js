"use strict";(globalThis.webpackChunkphysical_ai_robotics_book=globalThis.webpackChunkphysical_ai_robotics_book||[]).push([[675],{8118(e,s,i){i.r(s),i.d(s,{default:()=>o});var t=i(6540),a=i(6347),r=i(2360),n=i(9552),d=i(96),c=i(3),l=i(4848);function o(){const{user:e,loading:s}=(0,n.As)(),{t:i}=(0,d.B)(),o=(0,a.W6)(),[h,u]=(0,t.useState)([]),[m,x]=(0,t.useState)(!0),[j,p]=(0,t.useState)(null),A=c.DB;(0,t.useEffect)(()=>{if(!s&&e){e.isAdmin||"admin"===e.role||o.push("/")}},[e,s,o]),(0,t.useEffect)(()=>{e&&(e.isAdmin||"admin"===e.role)&&f()},[e]);const f=async()=>{try{x(!0),p(null);const e=await fetch(`${A}/api/auth/admin/users`,{credentials:"include"});if(!e.ok){let s="Failed to fetch users";try{const i=await e.json();s=i.error||i.message||s,console.error("Admin API error:",{status:e.status,statusText:e.statusText,error:i})}catch{s=`Server error: ${e.status} ${e.statusText}`}return void p(s)}const s=await e.json();u(s.users||[])}catch(e){console.error("Network error fetching users:",e),p(`Network error: ${e.message||"Please check if the server is running."}`)}finally{x(!1)}};return s||m?(0,l.jsx)(r.A,{title:"Admin Panel",children:(0,l.jsx)("div",{className:"auth-loading",children:i("common.loading")})}):!e||!e.isAdmin&&"admin"!==e.role?(0,l.jsx)(r.A,{title:"Access Denied",children:(0,l.jsx)("div",{className:"auth-container",children:(0,l.jsx)("div",{className:"auth-card",children:(0,l.jsx)("div",{className:"auth-error",children:"You don't have permission to access this page."})})})}):(0,l.jsx)(r.A,{title:"Admin Panel",description:"User management",children:(0,l.jsx)("div",{className:"auth-container",children:(0,l.jsxs)("div",{className:"auth-card",style:{maxWidth:"1200px"},children:[(0,l.jsxs)("div",{className:"auth-header",children:[(0,l.jsx)("h1",{children:"Admin Panel"}),(0,l.jsx)("p",{children:"Manage users and permissions"})]}),j&&(0,l.jsx)("div",{className:"auth-error",children:j}),(0,l.jsx)("div",{className:"admin-users-table",children:(0,l.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Email"}),(0,l.jsx)("th",{children:"Name"}),(0,l.jsx)("th",{children:"Verified"}),(0,l.jsx)("th",{children:"Role"}),(0,l.jsx)("th",{children:"Created"}),(0,l.jsx)("th",{children:"Actions"})]})}),(0,l.jsx)("tbody",{children:h.map(s=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:s.email}),(0,l.jsx)("td",{children:s.name||"-"}),(0,l.jsx)("td",{children:s.emailVerified?"\u2705":"\u274c"}),(0,l.jsx)("td",{children:s.isAdmin?"Admin":"User"}),(0,l.jsx)("td",{children:new Date(s.createdAt).toLocaleDateString()}),(0,l.jsxs)("td",{children:[(0,l.jsx)("button",{onClick:()=>(async(e,s)=>{try{(await fetch(`${A}/api/auth/admin/users/${e}/toggle-admin`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({isAdmin:!s})})).ok?f():p("Failed to update user")}catch(i){p("Network error")}})(s.id,s.isAdmin),className:"auth-submit",style:{marginRight:"8px",padding:"4px 12px",fontSize:"14px"},children:s.isAdmin?"Remove Admin":"Make Admin"}),s.id!==e.id&&(0,l.jsx)("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this user?"))try{(await fetch(`${A}/api/auth/admin/users/${e}`,{method:"DELETE",credentials:"include"})).ok?f():p("Failed to delete user")}catch(s){p("Network error")}})(s.id),className:"auth-submit",style:{padding:"4px 12px",fontSize:"14px",backgroundColor:"#dc3545"},children:"Delete"})]})]},s.id))})]})})]})})})}}}]);