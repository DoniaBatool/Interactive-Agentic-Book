"use strict";(globalThis.webpackChunkphysical_ai_robotics_book=globalThis.webpackChunkphysical_ai_robotics_book||[]).push([[675],{8118(e,s,i){i.r(s),i.d(s,{default:()=>l});var t=i(6540),a=i(2360),r=i(9552),n=i(96),d=i(3),c=i(4848);function l(){const{user:e,loading:s}=(0,r.As)(),{t:i}=(0,n.B)(),[l,o]=(0,t.useState)([]),[h,u]=(0,t.useState)(!0),[m,x]=(0,t.useState)(null),j=d.DB;(0,t.useEffect)(()=>{if(!s&&e){e.isAdmin||"admin"===e.role||(window.location.href="/")}},[e,s]),(0,t.useEffect)(()=>{e&&(e.isAdmin||"admin"===e.role)&&p()},[e]);const p=async()=>{try{u(!0),x(null);const e=await fetch(`${j}/api/auth/admin/users`,{credentials:"include"});if(!e.ok){let s="Failed to fetch users";try{const i=await e.json();s=i.error||i.message||s,console.error("Admin API error:",{status:e.status,statusText:e.statusText,error:i})}catch{s=`Server error: ${e.status} ${e.statusText}`}return void x(s)}const s=await e.json();o(s.users||[])}catch(e){console.error("Network error fetching users:",e),x(`Network error: ${e.message||"Please check if the server is running."}`)}finally{u(!1)}};return s||h?(0,c.jsx)(a.A,{title:"Admin Panel",children:(0,c.jsx)("div",{className:"auth-loading",children:i("common.loading")})}):!e||!e.isAdmin&&"admin"!==e.role?(0,c.jsx)(a.A,{title:"Access Denied",children:(0,c.jsx)("div",{className:"auth-container",children:(0,c.jsx)("div",{className:"auth-card",children:(0,c.jsx)("div",{className:"auth-error",children:"You don't have permission to access this page."})})})}):(0,c.jsx)(a.A,{title:"Admin Panel",description:"User management",children:(0,c.jsx)("div",{className:"auth-container",children:(0,c.jsxs)("div",{className:"auth-card",style:{maxWidth:"1200px"},children:[(0,c.jsxs)("div",{className:"auth-header",children:[(0,c.jsx)("h1",{children:"Admin Panel"}),(0,c.jsx)("p",{children:"Manage users and permissions"})]}),m&&(0,c.jsx)("div",{className:"auth-error",children:m}),(0,c.jsx)("div",{className:"admin-users-table",children:(0,c.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:"Email"}),(0,c.jsx)("th",{children:"Name"}),(0,c.jsx)("th",{children:"Verified"}),(0,c.jsx)("th",{children:"Role"}),(0,c.jsx)("th",{children:"Created"}),(0,c.jsx)("th",{children:"Actions"})]})}),(0,c.jsx)("tbody",{children:l.map(s=>(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:s.email}),(0,c.jsx)("td",{children:s.name||"-"}),(0,c.jsx)("td",{children:s.emailVerified?"\u2705":"\u274c"}),(0,c.jsx)("td",{children:s.isAdmin?"Admin":"User"}),(0,c.jsx)("td",{children:new Date(s.createdAt).toLocaleDateString()}),(0,c.jsxs)("td",{children:[(0,c.jsx)("button",{onClick:()=>(async(e,s)=>{try{(await fetch(`${j}/api/auth/admin/users/${e}/toggle-admin`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({isAdmin:!s})})).ok?p():x("Failed to update user")}catch(i){x("Network error")}})(s.id,s.isAdmin),className:"auth-submit",style:{marginRight:"8px",padding:"4px 12px",fontSize:"14px"},children:s.isAdmin?"Remove Admin":"Make Admin"}),s.id!==e.id&&(0,c.jsx)("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this user?"))try{(await fetch(`${j}/api/auth/admin/users/${e}`,{method:"DELETE",credentials:"include"})).ok?p():x("Failed to delete user")}catch(s){x("Network error")}})(s.id),className:"auth-submit",style:{padding:"4px 12px",fontSize:"14px",backgroundColor:"#dc3545"},children:"Delete"})]})]},s.id))})]})})]})})})}}}]);