"use strict";(globalThis.webpackChunkphysical_ai_robotics_book=globalThis.webpackChunkphysical_ai_robotics_book||[]).push([[563],{191(e,t,a){a.r(t),a.d(t,{default:()=>c});var i=a(6540),s=a(2360),r=a(96),n=a(3),o=a(4848);function c(){const{t:e}=(0,r.B)(),[t,a]=(0,i.useState)(""),[c,l]=(0,i.useState)(!0),[u,h]=(0,i.useState)(null),[d,f]=(0,i.useState)(null),m=n.DB;(0,i.useEffect)(()=>{if("undefined"!=typeof window){const e=new URLSearchParams(window.location.search).get("token");e?(a(e),v(e)):(f("Invalid verification link"),l(!1))}},[]);const v=async e=>{try{l(!0),f(null);let a=await fetch(`${m}/api/auth/verify-email?token=${encodeURIComponent(e)}`,{method:"GET",credentials:"include"});a.ok||404!==a.status||(console.log("GET failed, trying POST..."),a=await fetch(`${m}/api/auth/verify-email`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:e})}));let i={};try{const e=await a.text();e&&(i=JSON.parse(e))}catch(t){console.log("Response is not JSON, status:",a.status)}if(a.ok)h("Email verified successfully! Redirecting to sign in..."),setTimeout(()=>{window.location.href="/auth/signin"},2e3);else{const e=i.message||i.error?.message||`Failed to verify email (Status: ${a.status})`;f(e),console.error("Verification error:",{status:a.status,statusText:a.statusText,url:`${m}/api/auth/verify-email`,data:i})}}catch(a){console.error("Network error during verification:",a);const e=a.message||"Unknown error";f(`Network error: ${e}. Please check if the auth server is running on ${m}`)}finally{l(!1)}};return c?(0,o.jsx)(s.A,{title:e("auth.verifyEmail"),children:(0,o.jsx)("div",{className:"auth-container",children:(0,o.jsx)("div",{className:"auth-card",children:(0,o.jsx)("div",{className:"auth-loading",children:e("common.loading")})})})}):(0,o.jsx)(s.A,{title:e("auth.verifyEmail"),description:e("auth.emailVerificationRequired"),children:(0,o.jsx)("div",{className:"auth-container",children:(0,o.jsxs)("div",{className:"auth-card",children:[(0,o.jsxs)("div",{className:"auth-header",children:[(0,o.jsx)("h1",{children:e("auth.verifyEmail")}),(0,o.jsx)("p",{children:e("auth.emailVerificationRequired")})]}),d&&(0,o.jsx)("div",{className:"auth-error",children:d}),u&&(0,o.jsx)("div",{className:"auth-success",children:u}),!u&&(0,o.jsxs)("div",{className:"auth-footer",children:[(0,o.jsx)("p",{children:e("auth.checkYourEmail")}),(0,o.jsx)("button",{onClick:async()=>{try{f(null),l(!0);const a=await fetch(`${m}/api/auth/resend-verification`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"});let i={};try{const e=await a.text();e&&(i=JSON.parse(e))}catch(t){console.error("Failed to parse response:",t)}if(a.ok)h(e("auth.verificationSent")||"Verification email sent! Please check your inbox.");else{const e=i.message||i.error?.message||"Failed to resend verification email";f(e),console.error("Resend verification error:",{status:a.status,statusText:a.statusText,data:i})}}catch(a){console.error("Network error during resend:",a),f(`Network error: ${a.message||"Please check if the auth server is running"}`)}finally{l(!1)}},className:"auth-submit",style:{marginTop:"1rem"},children:e("auth.resendVerification")})]})]})})})}}}]);