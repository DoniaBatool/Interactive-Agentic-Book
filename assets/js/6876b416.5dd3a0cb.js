"use strict";(globalThis.webpackChunkphysical_ai_robotics_book=globalThis.webpackChunkphysical_ai_robotics_book||[]).push([[930],{3749(e,a,t){t.r(a),t.d(a,{default:()=>d});var s=t(6540),o=t(6347),i=t(4586),n=t(2360),r=t(9552),c=t(96),l=t(3),h=t(4848);function d(){const{login:e,user:a,loading:t,error:d,clearError:u,refreshSession:m}=(0,r.As)(),{t:w}=(0,c.B)(),p=(0,o.W6)(),{siteConfig:g}=(0,i.A)(),[x,f]=(0,s.useState)({email:"",password:"",rememberMe:!1}),[b,j]=(0,s.useState)(!1),[k,v]=(0,s.useState)(!1),[y,A]=(0,s.useState)(null);(0,s.useEffect)(()=>{if("undefined"!=typeof window&&!t){const e=new URLSearchParams(window.location.search),a=e.get("code"),t=e.get("error");if(t)return A(`OAuth error: ${t}. Please try again.`),void window.history.replaceState({},"",window.location.pathname);a&&!t&&m().then(async()=>{try{const a=await fetch(`${l.DB}/api/auth/get-user`,{credentials:"include"});if(a.ok){const t=await a.json();if(t.user){if(!!t.user.isAdmin||"admin"===t.user.role){try{await fetch(`${l.DB}/api/auth/block-admin-oauth`,{method:"POST",credentials:"include"})}catch(e){console.error("Error blocking admin OAuth:",e)}return await fetch(`${l.DB}/api/auth/sign-out`,{method:"POST",credentials:"include"}),A("Admin accounts cannot sign in via OAuth. Please use email/password login."),void window.history.replaceState({},"",window.location.pathname)}}}}catch(e){console.error("Error checking admin status:",e)}setTimeout(()=>{const e="undefined"!=typeof window&&"doniabatool.github.io"===window.location.hostname?"/Interactive-Agentic-Book/":"/";window.location.href=e},1500)}).catch(e=>{console.error("OAuth callback error:",e),A("Failed to complete sign-in. Please try again.")})}},[t,m,p]),(0,s.useEffect)(()=>{a&&!t&&p.push("/")},[a,t,p]);const N=e=>{const{name:a,value:t,type:s,checked:o}=e.target;f(e=>({...e,[a]:"checkbox"===s?o:t})),u()};return t?(0,h.jsx)(n.A,{title:w("common.signIn"),children:(0,h.jsx)("div",{className:"auth-loading",children:w("common.loading")})}):(0,h.jsx)(n.A,{title:w("common.signIn"),description:w("auth.signInToContinue"),children:(0,h.jsx)("div",{className:"auth-container",children:(0,h.jsxs)("div",{className:"auth-card auth-card-signin",children:[(0,h.jsxs)("div",{className:"auth-header",children:[(0,h.jsx)("h1",{children:w("auth.welcomeBack")}),(0,h.jsx)("p",{children:w("auth.signInToContinue")})]}),(0,h.jsxs)("form",{onSubmit:async a=>{a.preventDefault(),u(),j(!0);const t=await e(x.email,x.password,x.rememberMe);j(!1),t&&setTimeout(()=>{const e="undefined"!=typeof window&&"doniabatool.github.io"===window.location.hostname?"/Interactive-Agentic-Book/":"/";window.location.href=e},100)},className:"auth-form",children:[d&&(0,h.jsx)("div",{className:"auth-error",children:d}),(0,h.jsxs)("div",{className:"auth-field",children:[(0,h.jsx)("label",{htmlFor:"email",children:w("auth.email")}),(0,h.jsx)("input",{type:"email",id:"email",name:"email",value:x.email,onChange:N,required:!0,placeholder:"your@email.com",autoComplete:"email"})]}),(0,h.jsxs)("div",{className:"auth-field",children:[(0,h.jsx)("label",{htmlFor:"password",children:w("auth.password")}),(0,h.jsxs)("div",{className:"auth-password-wrapper",children:[(0,h.jsx)("input",{type:k?"text":"password",id:"password",name:"password",value:x.password,onChange:N,required:!0,placeholder:w("auth.password"),autoComplete:"current-password"}),(0,h.jsx)("button",{type:"button",className:"auth-password-toggle",onClick:()=>v(!k),"aria-label":w(k?"auth.hidePassword":"auth.showPassword"),children:k?(0,h.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,h.jsx)("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"}),(0,h.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):(0,h.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,h.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,h.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})})]})]}),(0,h.jsxs)("div",{className:"auth-options",children:[(0,h.jsxs)("label",{className:"auth-checkbox",children:[(0,h.jsx)("input",{type:"checkbox",name:"rememberMe",checked:x.rememberMe,onChange:N}),(0,h.jsx)("span",{children:w("auth.rememberMe")})]}),(0,h.jsx)("a",{href:"/auth/forgot-password",className:"auth-forgot-link",children:w("auth.forgotPassword")})]}),(0,h.jsx)("button",{type:"submit",className:"auth-submit",disabled:b,children:w(b?"auth.signingIn":"common.signIn")}),(0,h.jsxs)("div",{className:"auth-footer",children:[w("auth.dontHaveAccount")," ",(0,h.jsx)("a",{href:"/auth/signup",children:w("common.signUp")})]})]})]})})})}}}]);